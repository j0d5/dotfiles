##################################################
##                                              ##
## Author: Johannes Steudle                     ##
## File: .zsh_completion                        ##
## Date: 29.04.2010                             ##
##                                              ##
## Description: set completion for zsh          ##
##                                              ##
##################################################

##
## completion for *lots* of commands - man, ssh, etc
##

zmodload -i zsh/complist

##
## General completion technique
##

zstyle ':completion:*' completer _complete _correct _approximate _prefix
zstyle ':completion:*' completer _complete _prefix
# zstyle ':completion:*' completer _complete _list _oldlist _expand _ignored _match _correct _approximate _prefix
# zstyle ':completion:*' verbose yes
# Expand partial paths
zstyle ':completion:*' expand 'yes'
zstyle ':completion:*' squeeze-slashes 'yes'
zstyle ':completion:*' group-name ''
zstyle ':completion:*' file-sort name
zstyle ':completion:*' menu select=1
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Z}' 'r:|[._-]=* r:|=*' 'l:|=* r:|=*'
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion::prefix-1:*' completer _complete
zstyle ':completion:incremental:*' completer _complete _correct
zstyle ':completion:predict:*' completer _complete
# Separate matches into groups
zstyle ':completion:*:matches' group 'yes'


# Describe each match group.
# zstyle ':completion:*:descriptions' format "%B---- %d%b"
zstyle ':completion:*:descriptions' format "%{$fg_bold[green]%}%d%{$reset_color%}"

##
## Messages/warnings format
##

# zstyle ':completion:*:messages' format '%B%U---- %d%u%b'
# zstyle ':completion:*:warnings' format '%B%U---- no match for: %d%u%b'
zstyle ':completion:*:messages' format "%{$fg_no_bold[yellow]%}%d%{$reset_color%}"
zstyle ':completion:*:warnings' format "%{$fg_no_bold[red]%}No matches for: %d%{$reset_color%}"

##
## Completion caching
##
zstyle ':completion::complete:*' use-cache 1
zstyle ':completion::complete:*' cache-path ~/.zsh/cache/$HOST
# Don't complete backup files as executables
zstyle ':completion:*:complete:-command-::commands' ignored-patterns '*\~'

##
##
##
zstyle ':completion:*:corrections' format "%{$fg_bold[blue]%}%B%d (errors: %e)%b%{$reset_color%}"
zstyle ':completion:*:*:kill:*:processes' command 'ps -axco pid,user,command'
zstyle ':completion:*:*:kill:*:processes' list-colors '=(#b) #([0-9]#)*=0=01;31'


##
## Describe options in full
##

zstyle ':completion:*:options' description 'yes'
zstyle ':completion:*:options' auto-description '%d'

zstyle ':completion:*:history-words' stop yes
zstyle ':completion:*:history-words' remove-all-dups yes
zstyle ':completion:*:history-words' list false
zstyle ':completion:*:history-words' menu yes
